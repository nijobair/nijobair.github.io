SELECT
    TRIM(occupation) AS occupation,
    ROUND(AVG(
    CAST(
        REPLACE(REPLACE(salary, '$', ''),',', '') AS NUMERIC
        )
    )) AS average_salary
FROM village_x
WHERE occupation <> ''
GROUP BY TRIM(occupation)
ORDER BY average_salary DESC;